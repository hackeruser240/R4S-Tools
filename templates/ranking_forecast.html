<!-- File: templates/ranking_forecast.html -->

<!DOCTYPE html>
<html>
<head>
    <title>Ranking Forecast Dashboard</title>
    <meta charset="utf-8">
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        h1 { color: #333; }
        .section { margin-bottom: 40px; }
        .form-group { margin-bottom: 20px; }
        .summary { background: #f9f9f9; padding: 20px; border-left: 4px solid #007BFF; margin-bottom: 30px; }
        .button-group button { margin-right: 20px; padding: 10px 20px; font-size: 16px; }
    </style>
</head>
<body>
    <h1>📊 Keyword Ranking Forecast Dashboard</h1>


    <div class="section">
        <h3>🧭 How to Use the Keyword Ranking Forecast Tool</h3>
        <p>
            This tool helps you predict how a keyword might perform in search rankings over time. It’s useful for SEO planning, content strategy, and understanding keyword trends.
            <br><br>
            <strong>You have two options to get started:</strong><br>
            1. <strong>Preview Previously Loaded Data:</strong> View a sample forecast that’s already been generated.<br>
            2. <strong>Use Sample Data:</strong> Open the forecasting form, enter your keyword and forecast horizon, then click “Run Forecast”.
            <br><br>
            Once processed, you’ll see a summary, an interactive chart, a forecast table, and model diagnostics. No technical background is needed — just enter a keyword and explore the results.
        </p>
    </div>
    <br><hr><br>

    <div class="section">
        <h2>Choose an Option</h2>
        <div class="button-group">
            <form action="/aio/static/forecast_chart_MOF_membranes.html" method="get" target="_blank" style="display:inline;">
                <button type="submit">🔍 Preview Previously Loaded Data</button>
            </form>

            <form method="GET" action="/aio/ranking_forecast" style="display:inline;">
                <input type="hidden" name="load_sample" value="true">
                <button type="submit">📈 Use Sample Data</button>
            </form>
        </div>
    </div>

    {% if show_form %}
    <div class="section">
        <h2>📈 Keyword Ranking Forecast</h2>

        <form method="POST">
            <div class="form-group">
                <label for="keyword">Keyword:</label>
                <input type="text" name="keyword" value="{{ keyword }}">
            </div>
            <div class="form-group">
                <label for="forecast_horizon">Forecast Horizon (days):</label>
                <input type="number" name="forecast_horizon" value="{{ forecast_horizon }}">
            </div>
            <button type="submit">Run Forecast</button>
        </form>
    </div>
    {% endif %}

    {% if forecast_output %}
    <div class="section">
        <div class="summary">
            <h3>🧠 Summary</h3>
            <p>{{ summary_text }}</p>
        </div>

        <h2>📊 Forecast Chart</h2>
        <div>{{ chart_html | safe }}</div>

        <h2>🔍 Forecast Table</h2>
        <table border="1">
            <tr><th>Date</th><th>Predicted Rank</th></tr>
            {% for row in forecast_output.forecast %}
            <tr>
                <td>{{ row.date }}</td>
                <td>{{ row.predicted_rank }}</td>
            </tr>
            {% endfor %}
        </table>

        <h2>📈 Model Diagnostics</h2>
        <ul>
            <li>Keyword: {{ forecast_output.keyword }}</li>
            <li>Prophet RMSE: {{ forecast_output.model_metadata.prophet_rmse }}</li>
            <li>XGBoost RMSE: {{ forecast_output.model_metadata.xgboost_rmse }}</li>
            <li>Ensemble Strategy: {{ forecast_output.model_metadata.ensemble_strategy }}</li>
        </ul>
    </div>
    {% endif %}
</body>
</html>